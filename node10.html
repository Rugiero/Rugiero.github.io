<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>May – Rayleigh Fading Audiolized</TITLE>
<META NAME="description" CONTENT="May – Rayleigh Fading Audiolized">
<META NAME="keywords" CONTENT="source">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="source.css">

<LINK REL="previous" HREF="node9.html">
<LINK REL="next" HREF="node11.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node11.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node5.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node9.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html60"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  <A ID="tex2html1"
  HREF="https://www.dropbox.com/s/jem3l3jabcyex9s/Curriculum_Vitae_Ilari_Angervuori.pdf?dl=0"><IMG STYLE="" SRC="jetscalecropped.png"
 ALT="6"></A>
<BR>
<B> Next:</B> <A
 HREF="node11.html">About this document ...</A>
<B> Up:</B> <A
 HREF="node5.html">Blog posts 2021</A>
<B> Previous:</B> <A
 HREF="node9.html">April – Frequentist Inference</A>
 &nbsp; <B>  <A ID="tex2html61"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00034000000000000000">
May – Rayleigh Fading Audiolized</A>
</H2>
<P>
<EM>When a signal is propagating through multiple paths each signal component in each path will be in different phase and of different strength when received. Should there be no line-of-sight component present, the  additive signal will fade according to the <A ID="tex2html14"
  HREF="https://en.wikipedia.org/wiki/Rayleigh_fading">Rayleigh fading</A>.
</EM>
<P>
  <EM>For example, a simple sine wave
    <figure>
      <audio
        controls
        src="REF.wav">
        Your browser does not support the
        <code>audio</code> element.
      </audio>
    </figure>
</EM>
<P>
  <EM>can after some multi-path propagation sound something like
    <figure>
      <audio
        controls
        src="EZ.wav">
        Your browser does not support the
        <code>audio</code> element.
      </audio>
    </figure>
  </EM>
<P>
  <EM>assuming that the receiver is moving at a constant speed, so that variation in the Doppler shifts in the signals propagating through different paths will cause the aggregate signal to vary randomly in time.
  </EM>
<P>
  <EM>If we add a Gaussian noise component we will notice that the original signal is somehow recognisable from the noise
    <figure>
      <audio
        controls
        src="REFNOISE.wav">
        Your browser does not support the
        <code>audio</code> element.
      </audio>,
    </figure>        
</EM>
<P>
  <EM>but the faded signal
    <figure>
      <audio
        controls
        src="EZNOISE.wav">
        Your browser does not support the
        <code>audio</code> element.
      </audio>
    </figure>        
</EM>
<P>
<EM>will sometimes be buried completely under the noise – these events are referred to as <SPAN  CLASS="textbf">deep fades</SPAN>.
</EM>
<P>
  <BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<EM>Here is a GNU/Octave or Matlab code for the used Rayleigh simulator:
</EM><PRE>
%Rayleigh simulator. Jakes model. In Octave remember to load the statistics package.

close all
clear all

tic

N = 20; %Number multipaths.
T= linspace(0,10000,100000); %Time.
v = 0.001; %Speed of the receiver.
randan = pi*rand(1,N); %Random angles w.r.t. receiver.
rI = 1000*rand(1,N); %Random distances of the sources.

%Geometrical stuff. Check for the Jakes model in the reference.
An = @(t) (atan(sin(randan).*rI./(cos(randan).*rI-v*t))).*(cos(randan).*rI&gt;v*t)+...
     (pi-atan(sin(randan).*rI./(v*t-cos(randan).*rI))).*(cos(randan).*rI&lt;=v*t);
phis = 2*pi.*(rand(1,N));
wc =pi/2; %Frequency of the signal.
Beta = 2*pi/(1/(wc/(2*pi)));
theta = @(t) cos(An(t)).*Beta*v.*t+phis;

powers = rand(1,N); %Random powers of the signals in the multipaths.
powers = powers./sum(powers); %Normalize the powers.
Ez = @(t) sum(powers.*cos(wc*t+theta(t)));
EZ = []; %Faded signal.
REF = []; %Original signal.
NOISE = []; %Additional Gaussian noise.
for t =T
    EZ = [EZ Ez(t)];
    REF = [REF cos(wc*t)];
    NOISE = [NOISE 0.9*stdnormal_rnd(1)];
end

%Write the audio files at sampling rate 8000.
audiowrite('EZ.wav',EZ,8000)
audiowrite('EZNOISE.wav',1/2*(EZ+NOISE),8000)
audiowrite('REFNOISE.wav', 1/2*(REF+NOISE), 8000)


toc
plot(T,EZ)
</PRE>
<P>
<EM>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
And the same in Python:
</EM>
<P><PRE>
import numpy as np
import math
import matplotlib.pyplot as plt
import sounddevice as sd
import time

#Jakes Rayleigh simulator. Please check for the reference in this site for further details.

N = 20 #Number of multipaths.
T = np.linspace(0, 10000, 100000) #Time vector.
v = 0.001 #Speed of the receiver. 



randan = np.random.rand(1, N) * math.pi #Random angles w.r.t. receiver.
rI = np.random.rand(1, N) * 1000 #Random distances of the sources.
phis = np.random.rand(1, N) * 2 * math.pi 

def An(t):
    return (np.arctan(np.sin(randan) * rI / (np.cos(randan) * rI - v * t))) * (
        np.cos(randan) * rI &gt; v * t
    ) + (np.pi - np.arctan(np.sin(randan) * rI / (v * t - np.cos(randan) * rI))) * (
        np.cos(randan) * rI &lt;= v * t
    )

wc = np.pi/2 #Frequency of the signal.
Beta = 2 * math.pi / (1 / (wc / (2 * math.pi)))

def theta(t):
    return np.cos(An(t)) * Beta * v * t +phis

powers = np.random.rand(1,N)*2 #Random powers of the signals in the multipaths.
powers = powers/np.sum(powers) #Normalize powers..

def Ez(t):
    return np.sum(powers * np.cos(wc * t + theta(t)))

EZ = np.vectorize(Ez)(T)
REF = np.vectorize(lambda time : 2*np.cos(wc * time))(T)

#Play and plot.
fs = 8000
sd.play(EZ,fs,blocking = True)
#sd.play(REF,fs,blocking = True)
plt.plot(T, EZ)
plt.show()
</PRE>
<P>
<EM>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
References:
<DT><A ID="theoryofpoint">1</A>
<DD> William C. Jakes, <EM>Microwave Mobile Communications</EM>, IEEE PRESS, 1974. 
</EM>
<P>
<BR><HR>

</BODY>
</HTML>
